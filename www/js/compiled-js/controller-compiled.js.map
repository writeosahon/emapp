{"version":3,"sources":["controller.js"],"names":[],"mappings":"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","file":"controller-compiled.js","sourcesContent":["/**\r\n * Created by UTOPIA SOFTWARE on 19/02/2018.\r\n */\r\n\r\n/**\r\n * file defines all View-Models, Controllers and Event Listeners used by the app\r\n *\r\n * The 'utopiasoftware.emap' namespace has being defined in the base js file.\r\n * The author uses the terms 'method' and function interchangeably; likewise the terms 'attribute' and 'property' are\r\n * also used interchangeably\r\n */\r\n\r\n\r\n// define the controller namespace\r\nutopiasoftware.emap.controller = {\r\n\r\n    /**\r\n     * method contains the stratup/bootstrap code needed to initiate app logic execution\r\n     */\r\n    startup: function(){\r\n\r\n        // initialise the onsen library\r\n        ons.ready(function () {\r\n            // set the default handler for the app\r\n            ons.setDefaultDeviceBackButtonListener(function(){\r\n                // does nothing for now!!\r\n            });\r\n\r\n            if(utopiasoftware.emap.model.isAppReady === false){ // if app has not completed loading\r\n                // displaying prepping message\r\n                $('#loader-modal-message').html(\"Loading App...\");\r\n                $('#loader-modal').get(0).show(); // show loader\r\n            }\r\n\r\n            // load the app 1st page\r\n            $('ons-splitter').get(0).content.load(\"app-main-template\");\r\n\r\n            // START CORDOVA PLUGIN CONFIGURATIONS\r\n            try {\r\n                // lock the orientation of the device to 'PORTRAIT'\r\n                screen.lockOrientation('portrait');\r\n            }\r\n            catch(err){}\r\n\r\n            // set status bar color\r\n            StatusBar.backgroundColorByHexString(\"#DC723D\");\r\n            navigator.splashscreen.hide(); // hide the splashscreen\r\n\r\n            utopiasoftware.emap.model.isAppReady = true; // true that app is fully loaded and ready\r\n\r\n\r\n        }); // end of ons.ready()\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * object is view-model for toc page\r\n     */\r\n    tocPageViewModel: {\r\n\r\n\r\n        /**\r\n         * property holds the toc date picker\r\n         */\r\n        tocDatePicker: null,\r\n\r\n        /**\r\n         * property holds the grid for toc\r\n         */\r\n        tocGrid: null,\r\n\r\n        /**\r\n         * event is triggered when page is initialised\r\n         */\r\n        pageInit: function(event){\r\n\r\n            var $thisPage = $(event.target); // get the current page shown\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n\r\n            // call the function used to initialise the app page if the app is fully loaded\r\n            loadPageOnAppReady();\r\n\r\n            //function is used to initialise the page if the app is fully ready for execution\r\n            function loadPageOnAppReady(){\r\n                // check to see if onsen is ready and if all app loading has been completed\r\n                if(!ons.isReady() || utopiasoftware.emap.model.isAppReady === false){\r\n                    setTimeout(loadPageOnAppReady, 500); // call this function again after half a second\r\n                    return;\r\n                }\r\n\r\n                // listen for the back button event\r\n                $thisPage.get(0).onDeviceBackButton = utopiasoftware.emap.controller.tocPageViewModel.backButtonClicked;\r\n\r\n                // inject the the modules required to create the transaction history grid\r\n                ej.grids.Grid.Inject(ej.grids.Page, ej.grids.Selection, ej.grids.Scroll, ej.grids.Search, ej.grids.Toolbar,\r\n                    ej.grids.DetailRow,\r\n                    ej.grids.PdfExport, ej.grids.ExcelExport, ej.grids.Group, ej.grids.Aggregate);\r\n\r\n                // create the date picker\r\n                utopiasoftware.emap.controller.tocPageViewModel.tocDatePicker =\r\n                    new ej.calendars.DatePicker({\r\n                        placeholder: 'Pick Meeting Date',\r\n                        floatLabelType: 'Auto',\r\n                        readonly: true,\r\n                        // sets the value.\r\n                        value: new Date(),\r\n                        // sets the min date\r\n                        //min: new Date(),\r\n                        //sets the max date\r\n                        max: new Date(),\r\n                        format: 'yyyy-MM-dd',\r\n                        focus: function(){ // listen for when component has focus\r\n                            // open the date picker\r\n                            utopiasoftware.emap.controller.tocPageViewModel.tocDatePicker.show();\r\n                        },\r\n                        change: function(){\r\n\r\n                            utopiasoftware.emap.controller.tocPageViewModel.\r\n                            updateTocGrid(kendo.toString(utopiasoftware.emap.controller.tocPageViewModel.\r\n                                tocDatePicker.value, 'yyyy-MM-dd'));\r\n                        }\r\n                    });\r\n\r\n                // render initialized toc DatePicker\r\n                utopiasoftware.emap.controller.tocPageViewModel.tocDatePicker.\r\n                appendTo('#toc-date-picker');\r\n\r\n                utopiasoftware.emap.controller.tocPageViewModel.\r\n                updateTocGrid(kendo.toString(utopiasoftware.emap.controller.tocPageViewModel.tocDatePicker.value, 'yyyy-MM-dd'));\r\n\r\n                // hide the loader\r\n                $('#loader-modal').get(0).hide();\r\n\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * method is triggered when page is shown\r\n         */\r\n        pageShow: function(){\r\n            // disable the swipeable feature for the app splitter\r\n            $('ons-splitter-side').removeAttr(\"swipeable\");\r\n            //$('#menu-tabbar .tabbar__border').css(\"visibility\", \"hidden\");\r\n        },\r\n\r\n\r\n        /**\r\n         * method is triggered when page is hidden\r\n         */\r\n        pageHide: function(){\r\n            // stop the rotating animation on main menu page\r\n            //$('.rotating-infinite-ease-in-1').addClass('rotating-infinite-ease-in-1-paused');\r\n        },\r\n\r\n        /**\r\n         * method is triggered when back button or device back button is clicked\r\n         */\r\n        backButtonClicked: function(){\r\n\r\n            // check if the side menu is open\r\n            if($('ons-splitter').get(0).right.isOpen){ // side menu open, so close it\r\n                $('ons-splitter').get(0).right.close();\r\n                return; // exit the method\r\n            }\r\n\r\n            ons.notification.confirm('Do you want to close the app?', {title: 'Exit App',\r\n                    buttonLabels: ['No', 'Yes']}) // Ask for confirmation\r\n                .then(function(index) {\r\n                    if (index === 1) { // OK button\r\n                        navigator.app.exitApp(); // Close the app\r\n                    }\r\n                });\r\n        },\r\n\r\n        /**\r\n         * method is used to create/update the toc grid component\r\n         */\r\n        updateTocGrid: function(meetingDateString){\r\n\r\n            // check if the TOC Grid has been created before, if so, show spinner\r\n            if(utopiasoftware.emap.controller.tocPageViewModel.tocGrid){ // grid has previously been created\r\n                // show spinner for the grid object\r\n                utopiasoftware.emap.controller.tocPageViewModel.tocGrid.showSpinner();\r\n            }\r\n\r\n            // call the method that will load the table of content for the exco meeting\r\n            utopiasoftware.emap.controller.tocPageViewModel.\r\n            tocFileReader(meetingDateString, \"content.json\").\r\n            then(function(dataObject){\r\n                if(utopiasoftware.emap.controller.tocPageViewModel.tocGrid){ // grid has previously been created\r\n                    // hide spinner\r\n                    utopiasoftware.emap.controller.tocPageViewModel.tocGrid.hideSpinner();\r\n                    // destroy the grid object\r\n                    utopiasoftware.emap.controller.tocPageViewModel.tocGrid.destroy();\r\n                }\r\n\r\n                utopiasoftware.emap.controller.tocPageViewModel.tocGrid =\r\n                    new ej.grids.Grid({\r\n                        // Width for grid\r\n                        width: '100%',\r\n                        allowTextWrap: true,\r\n                        toolbar: ['search'],\r\n                        columns: [\r\n                            { field: 'sno',\r\n                                headerText: '<div style=\"color: #f28340; width: 100%; height: 100%; font-size: 1.2em; text-transform: uppercase\">S/N</div>',\r\n                                width: \"10%\", clipMode: 'ellipsiswithtooltip', customAttributes: {\r\n                                class: 'toc-grid-sno-column'}\r\n                            },\r\n                            { field: 'subject',\r\n                                headerText: '<div style=\"color: #f28340; width: 100%; height: 100%; font-size: 1.2em; text-transform: uppercase\">Subject</div>',\r\n                                width: \"30%\", clipMode: 'ellipsiswithtooltip', customAttributes: {\r\n                                class: 'toc-grid-subject-column'}\r\n                            },\r\n                            { field: 'agenda',\r\n                                headerText: '<div style=\"color: #f28340; width: 100%; height: 100%; font-size: 1.2em; text-transform: uppercase\">Agenda</div>',\r\n                                width: \"35%\", clipMode: 'ellipsiswithtooltip', customAttributes: {\r\n                                class: 'toc-grid-agenda-column'}\r\n                            },\r\n                            { field: 'sno',\r\n                                headerText: '',\r\n                                width: \"25%\", template: '#attachments-column-template', clipMode: 'ellipsiswithtooltip'}\r\n                        ],\r\n                        dataSource: dataObject.toc,\r\n                        childGrid: {\r\n                            dataSource: dataObject.attachments,\r\n                            queryString: 'sno',\r\n                            columns: [\r\n                                { field: 'filename', headerText: 'Attachments', width: '80%', customAttributes: {\r\n                                    class: 'toc-grid-attachments-filename-column'}},\r\n                                { field: 'fileurl',\r\n                                    headerText: '',\r\n                                    width: \"20%\", template: '#view-attachment-column-template', clipMode: 'ellipsiswithtooltip'}\r\n                            ]\r\n                        }\r\n                    });\r\n\r\n                //append the newly created grid\r\n                utopiasoftware.emap.controller.tocPageViewModel.tocGrid.\r\n                appendTo('#toc-grid');\r\n\r\n            }).catch(function(err){console.log(err);});\r\n\r\n        },\r\n\r\n\r\n        tocFileReader: function(directoryName, fileName){\r\n\r\n            var mainPromiseResolve = null;\r\n            var mainPromiseReject = null;\r\n\r\n            var mainPromise = new Promise(function(mainResolve, mainReject){\r\n\r\n                mainPromiseResolve = mainResolve;\r\n                mainPromiseReject = mainReject;\r\n\r\n                new Promise(function(resolve, reject){ // request file read write permissions\r\n                    cordova.plugins.diagnostic.requestRuntimePermissions(resolve, reject, [\r\n                        cordova.plugins.diagnostic.permission.WRITE_EXTERNAL_STORAGE,\r\n                        cordova.plugins.diagnostic.permission.READ_EXTERNAL_STORAGE\r\n                    ])\r\n                }).\r\n                then(function(statuses){\r\n                    console.log(\"READ\", statuses[cordova.plugins.diagnostic.permission.READ_EXTERNAL_STORAGE]);\r\n                    if(! (statuses[cordova.plugins.diagnostic.permission.WRITE_EXTERNAL_STORAGE] ===\r\n                        cordova.plugins.diagnostic.permissionStatus.GRANTED ||\r\n                        statuses[cordova.plugins.diagnostic.permission.READ_EXTERNAL_STORAGE] ===\r\n                        cordova.plugins.diagnostic.permissionStatus.GRANTED)){\r\n                        throw \"error\";\r\n                    }\r\n                    return new Promise(function(resolve, reject){ // return the directory where to store the document/image\r\n                        window.resolveLocalFileSystemURL(cordova.file.externalRootDirectory, resolve, reject);\r\n                    });\r\n                }).\r\n                then(function(rootDir){ // get the device root directory\r\n                    return new Promise(function(resolve, reject){\r\n                        // read from the EMAPP/[MEETING-DATE] directory contained in the root directory\r\n                        rootDir.getDirectory(\"EMAPP/\" + directoryName, {create: false}, resolve, reject);\r\n                    });\r\n                }).\r\n                then(function(meetingDir){\r\n                    console.log(meetingDir.toURL());\r\n                    return new Promise(function(resolve, reject){\r\n                        meetingDir.getFile(fileName, {create: false}, resolve, reject);\r\n                    });\r\n                }).\r\n                then(function(fileEntry){\r\n                    return new Promise(function(resolve, reject){ // return the FileWriter object used to write content to the created file\r\n                        fileEntry.file(resolve, reject);\r\n                    });\r\n                }).\r\n                then(function(file){\r\n\r\n                    return new Promise(function(resolve, reject){\r\n                        var fileReader = new FileReader();\r\n                        fileReader.onloadend = function(){\r\n                            resolve(this.result);\r\n                        };\r\n\r\n\r\n                        fileReader.readAsText(file); // read the file\r\n                    });\r\n                }).\r\n                then(function(fileContent){\r\n                    console.log(fileContent);\r\n                    mainPromiseResolve(JSON.parse(fileContent));\r\n                }).\r\n                catch(function(err){\r\n                    console.log(\"ERROR\", err);\r\n                    mainPromiseResolve({toc: [], attachments: []});\r\n                });\r\n            });\r\n\r\n            return mainPromise;\r\n        },\r\n\r\n        viewAttachmentsList: function(projectSerialNumber, buttonElem){\r\n            var rowIndex = kendo.parseInt(projectSerialNumber) - 1;\r\n            switch($(buttonElem).attr('data-emap-grid-row-state')){\r\n                case \"collapsed\":\r\n                    utopiasoftware.emap.controller.tocPageViewModel.tocGrid.detailRowModule.expand(rowIndex);\r\n                    $(buttonElem).attr('data-emap-grid-row-state', \"expanded\");\r\n                    break;\r\n                case \"expanded\":\r\n                    utopiasoftware.emap.controller.tocPageViewModel.tocGrid.detailRowModule.collapse(rowIndex);\r\n                    $(buttonElem).attr('data-emap-grid-row-state', \"collapsed\");\r\n                    break;\r\n            }\r\n\r\n        },\r\n\r\n        viewAttachment: function(buttonElem){\r\n            var fileurl = $(buttonElem).attr('data-emap-fileurl');\r\n            // get the absolute url for the atachment to be displayed\r\n            var absoluteURL = cordova.file.externalRootDirectory + \"EMAPP/\" +\r\n                kendo.toString(utopiasoftware.emap.controller.tocPageViewModel.tocDatePicker.value, 'yyyy-MM-dd') +\r\n                    \"/ATTACHMENTS/\" + fileurl;\r\n            console.log(\"FILE URL \", absoluteURL);\r\n\r\n            new Promise(function(resolve, reject){\r\n                cordova.plugins.fileOpener2.showOpenWithDialog(\r\n                    absoluteURL,\r\n                    'application/pdf',\r\n                    {\r\n                        error : reject,\r\n                        success : resolve\r\n                    }\r\n                );\r\n            });\r\n\r\n        }\r\n    }\r\n};\r\n"]}